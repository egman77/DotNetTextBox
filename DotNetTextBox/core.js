var sel=null;function buildDiv(tid,url,w,h,divid){if(document.getElementById(divid)==null){var content,cssclass="popupmenu_popup2";switch(divid)
{case tid+"_popup_fontname_menu":content="<TABLE border=0 cellPadding=4 cellSpacing=0 unselectable=\"on\"><TBODY><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'simsun')\" unselectable=\"on\"><FONT face='simsun' unselectable=\"on\">"+simsun+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname','SimHei')\" unselectable=\"on\"><FONT face='simhei' unselectable=\"on\">"+simhei+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'LiSu')\" unselectable=\"on\"><FONT face='LiSu' unselectable=\"on\">"+stliti+"</FONT></TD></TR>";content+="<TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'YouYuan')\" unselectable=\"on\"><FONT face='YouYuan' unselectable=\"on\">"+simyou+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'KaiTi_GB2312')\" unselectable=\"on\"><FONT face='KaiTi_GB2312' unselectable=\"on\">"+simkai+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'FangSong_GB2312')\" unselectable=\"on\"><FONT face='FangSong_GB2312' unselectable=\"on\">"+simfang+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'NSimSun')\" unselectable=\"on\"><FONT face='NSimSun' unselectable=\"on\">"+newsimsun+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'STCaiyun')\" unselectable=\"on\"><FONT face='STCaiyun' unselectable=\"on\">"+stcaiyun+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'STFangsong')\" unselectable=\"on\"><FONT face='STFangsong' unselectable=\"on\">"+stfangso+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'stxinwei')\" unselectable=\"on\">";content+="<FONT face='stxinwei' unselectable=\"on\">"+stxinwei+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Arial')\" unselectable=\"on\"><FONT face=\"Arial\" unselectable=\"on\">Arial</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Arial Black')\" unselectable=\"on\"><FONT face=\"Arial Black\" unselectable=\"on\">Arial Black</FONT></TD>";content+="</TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Arial Narrow')\" unselectable=\"on\"><FONT face=\"Arial Narrow\" unselectable=\"on\">Arial Narrow</FONT></TD>";content+="</TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Century')\" unselectable=\"on\"><FONT face=\"Century\" unselectable=\"on\">Century</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Courier New')\" unselectable=\"on\"><FONT face=\"Courier New\" unselectable=\"on\">Courier New</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Georgia')\" unselectable=\"on\"><FONT face=\"Georgia\" unselectable=\"on\">Georgia</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Impact')\" unselectable=\"on\"><FONT face=\"Impact\" unselectable=\"on\">Impact</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Lucida Console')\" unselectable=\"on\"><FONT face=\"Lucida Console\" unselectable=\"on\">Lucida Console</FONT></TD>";content+="</TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'MS Sans Serif')\" unselectable=\"on\"><FONT face=\"MS Sans Serif\" unselectable=\"on\">MS Sans Serif</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'System')\" unselectable=\"on\"><FONT face=\"System\" unselectable=\"on\">System</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Symbol')\" unselectable=\"on\">Symbol</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Tahoma')\" unselectable=\"on\"><FONT face=\"Tahoma\" unselectable=\"on\">Tahoma</FONT></TD>";content+="</TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Times New Roman')\" unselectable=\"on\"><FONT face=\"Times New Roman\" unselectable=\"on\">Times New Roman</FONT></TD>";content+="</TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Verdana')\" unselectable=\"on\"><FONT face=\"Verdana\" unselectable=\"on\">Verdana</FONT></TD>";content+="</TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Webdings')\" unselectable=\"on\">Webdings</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Wingdings')\" unselectable=\"on\">Wingdings</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Webdings')\" unselectable=\"on\">Webdings</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'custom')\" unselectable=\"on\">"+custom+"</TD></TR></TBODY></TABLE>";cssclass="popupmenu_popup";break;case tid+"_popup_emot_menu":content="<iframe width="+w+" height="+h+" scrolling=no frameBorder=0 src='"+url+"emot.aspx?name=dntb_"+tid+"'></iframe>";break;case tid+"_popup_fontsize_menu":content="<TABLE cellspacing=\"0px\" cellPadding=4 border=0 unselectable=\"on\" width="+w+" height="+h+"><TBODY><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize','26pt')\" unselectable=\"on\"><FONT style='FONT-SIZE: 26pt' unselectable=\"on\">1</FONT></TD></TR><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize', '22pt')\" unselectable=\"on\"><FONT style='FONT-SIZE: 22pt' unselectable=\"on\">2</FONT></TD></TR><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize','16pt')\" unselectable=\"on\"><FONT style='FONT-SIZE: 16pt' unselectable=\"on\">3</FONT></TD></TR><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize', '14pt')\" unselectable=\"on\"><FONT style='FONT-SIZE: 14pt' unselectable=\"on\">4</FONT></TD></TR><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize','10.5pt')\" unselectable=\"on\"><FONT style='FONT-SIZE: 10.5pt' unselectable=\"on\">5</FONT></TD></TR><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize', '7.5pt')\" unselectable=\"on\"><FONT style='FONT-SIZE: 7.5pt' unselectable=\"on\">6</FONT></TD></TR><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize', '5.5pt')\" unselectable=\"on\"><FONT style='FONT-SIZE: 5.5pt' unselectable=\"on\">7</FONT></TD></TR></TBODY></TABLE>";break;case tid+"_popup_paragraph_menu":content="<TABLE border=0 cellspacing=\"0px\" width="+w+" height="+h+" unselectable=\"on\"><TBODY><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<P>')\" unselectable=\"on\">"+normal+"</TD></TR><TR><TD class=popupmenu_option style=\"PADDING-LEFT: 5px;\" onclick=\"format(dntb_"+tid+",'formatblock', '<H1>')\"><h1 unselectable=\"on\">"+h1+"</h1></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<H2>')\"><h2 unselectable=\"on\">"+h2+"</h2></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<H3>')\"><h3 unselectable=\"on\">"+h3+"</h3></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<H4>')\"><h4 unselectable=\"on\">"+h4+"</h4></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<H5>')\"><h5 unselectable=\"on\">"+h5+"</h5></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<H6>')\"><h6 unselectable=\"on\">"+h6+"</h6></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<p>')\" unselectable=\"on\">"+paragraph+"</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<dd>')\" unselectable=\"on\">"+dd+"</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<dt>')\" unselectable=\"on\">"+dt+"</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<dir>')\" unselectable=\"on\">"+dirlist+"</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<menu>')\" unselectable=\"on\">"+menulist+"</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<PRE>')\" unselectable=\"on\">"+pre+"</TD></TR></TBODY></TABLE>";cssclass="popupmenu_popup";break;case tid+"_popup_formatstripper_menu":content="<TABLE cellspacing=\"0px\" cellPadding=4 border=0 unselectable=\"on\" width="+w+" height="+h+"><TBODY><TR><TD class=popupmenu_option onClick=\"formatstripper(dntb_"+tid+",'html')\" unselectable=\"on\">"+delhtmltag+"</TD></TR><TR><TD class=popupmenu_option onClick=\"formatstripper(dntb_"+tid+",'word')\" unselectable=\"on\">"+delwordtag+"</TD></TR><TR><TD class=popupmenu_option onClick=\"formatstripper(dntb_"+tid+",'style')\" unselectable=\"on\">"+delstyletag+"</TD></TR><TR><TD class=popupmenu_option onClick=\"formatstripper(dntb_"+tid+",'font')\" unselectable=\"on\">"+delfonttag+"</TD></TR><TR><TD class=popupmenu_option onClick=\"formatstripper(dntb_"+tid+",'span')\" unselectable=\"on\">"+delspantag+"</TD></TR></TBODY></TABLE>";break;case tid+"_popup_specialtype_menu":content="<TABLE border=0 cellspacing=\"0px\" width="+w+" height="+h+" unselectable=\"on\"><TBODY><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'sup')\" unselectable=\"on\">X<Sup>2</Sup></TD></TR><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'sub')\" unselectable=\"on\">X<Sub>2</Sub></TD></TR><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'address')\"><ADDRESS  unselectable=\"on\">"+address+"</ADDRESS></TD></TR><TR><TD class=popupmenu_option onClick=\"openDialog(dntb_"+tid+",'"+functionstr+"color.aspx','230','230','shine')\" unselectable=\"on\">"+shine+"</TD></TR><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'marquee')\"><MARQUEE scrollAmount=3 behavior=alternate style=\"cursor:pointer\" unselectable=\"on\">"+marquee+"</MARQUEE></TD></TR><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'del')\"><del unselectable=\"on\">"+delline+"<del></TD></TR><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'big')\" unselectable=\"on\">"+big+"</TD></TR><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'small')\" unselectable=\"on\">"+small+"</TD></TR></TBODY></TABLE>";break;default:content="<iframe width="+w+"px height="+h+"px scrolling=no frameBorder=0 src='"+functionstr+url+".aspx?name=dntb_"+tid+"&type="+divid+"'></iframe>";break;}
var popMenu2=new dhLayer(window,cssclass);popMenu2.id=divid;popMenu2.content=content;popMenu2.show(w,h,document.body);}}
function colordialog(type,obj,divid){var e=event.srcElement?event.srcElement:event.target;e.onkeyup=colordialog;var oSel=GetSelection(document.getElementById('dntb_'+obj).contentWindow);var el=null,nowcolor=null;if(type!='bgcolor'){if(oSel.parentElement!=null){el=GetElement(oSel.parentElement(),"FONT");if(!el)el=GetElement(oSel.parentElement(),"A");if(!el){nowcolor='#FFFFFF';}else{nowcolor=el.color;}}}else{if(oSel.parentElement!=null){el=GetElement(oSel.parentElement(),"FONT");if(!el)el=GetElement(oSel.parentElement(),"TD");if(!el)el=GetElement(oSel.parentElement(),"TH");if(!el)el=GetElement(oSel.parentElement(),"TR");if(!el)el=GetElement(oSel.parentElement(),"TABLE");}
else
el=GetElement(oSel.item(0),"TABLE");if(!el){nowcolor='#FFFFFF';}else{nowcolor=el.bgColor?el.bgColor:el.style.backgroundColor;}}var ocbody;var colorlist=new Array(40);popMenu.id=divid;colorlist[0]="#000000";colorlist[1]="#993300";colorlist[2]="#333300";colorlist[3]="#003300";colorlist[4]="#003366";colorlist[5]="#000080";colorlist[6]="#333399";colorlist[7]="#333333";colorlist[8]="#800000";colorlist[9]="#FF6600";colorlist[10]="#808000";colorlist[11]="#008000";colorlist[12]="#008080";colorlist[13]="#0000FF";colorlist[14]="#666699";colorlist[15]="#808080";colorlist[16]="#FF0000";colorlist[17]="#FF9900";colorlist[18]="#99CC00";colorlist[19]="#339966";colorlist[20]="#33CCCC";colorlist[21]="#3366FF";colorlist[22]="#800080";colorlist[23]="#999999";colorlist[24]="#FF00FF";colorlist[25]="#FFCC00";colorlist[26]="#FFFF00";colorlist[27]="#00FF00";colorlist[28]="#00FFFF";colorlist[29]="#00CCFF";colorlist[30]="#993366";colorlist[31]="#CCCCCC";colorlist[32]="#FF99CC";colorlist[33]="#FFCC99";colorlist[34]="#FFFF99";colorlist[35]="#CCFFCC";colorlist[36]="#CCFFFF";colorlist[37]="#99CCFF";colorlist[38]="#CC99FF";colorlist[39]="#FFFFFF";ocbody="";ocbody+="<table CELLPADDING=0 CELLSPACING=3>";ocbody+="<tr height='20' width='20'><td align='center'><table style='border:1px solid #808080;' width='12' height='12' bgcolor='"+nowcolor+"'><tr><td></td></tr></table></td><td bgcolor='eeeeee' colspan='7' style='font-size:12px;' align='center'>"+nowcolorstr+"</td></tr>";for(var i=0;i<colorlist.length;i++){if(i%8==0)
ocbody+="<tr>";ocbody+="<td width='14' height='16' style='border:1px solid;' onMouseOut='colordialogmouseout(this);' onMouseOver='colordialogmouseover(this);' onMouseDown='colordialogmousedown(\""+colorlist[i]+"\",\""+type+"\",\""+obj+"\")' align='center' valign='middle'><table style='border:1px solid #808080;' width='12' height='12' bgcolor='"+colorlist[i]+"'><tr><td></td></tr></table></td>";if(i%8==7)
ocbody+="</tr>";}
ocbody+="<tr><td align='center' height='22' colspan='8' onMouseOut='colordialogmouseout(this);' onMouseOver='colordialogmouseover(this);' style='border:1px solid;font-size:12px;cursor:default;' unselectable='on' onmouseup='popupmenu.hide();openDialog(dntb_"+obj+",\""+functionstr+"color.aspx\",\"230\",\"230\",\""+type+"\")'>"+customcolorstr+"</td></tr>";ocbody+="</table>";popMenu.content=ocbody;popMenu.show(158,158,document.body);}
function pasteContent(idEdit){if(!Error(idEdit))return;idEdit.focus();idEdit.document.execCommand("Paste");}
function pasteword(idEdit){if(!Error(idEdit))return;var sText=GetClipboardData();var re=/<\w[^>]*class="?MsoNormal"?/gi;idEdit.focus();if(re.test(sText)){if(confirm(removedwordformat)){sText=cleanCode(sText,"word");}}
sel=idEdit.document.selection.createRange();sel.pasteHTML(sText);}
function pastetext(idEdit){if(!Error(idEdit))return;idEdit.focus();var sText=clipboardData.getData('text');sel=idEdit.document.selection.createRange();sel.pasteHTML(sText);}
function GetClipboardData(){;if(document.getElementById('DotNetTextBox_Temp')==null){var Temp=document.body.appendChild(document.createElement('div'));Temp.setAttribute('id','DotNetTextBox_Temp');Temp.visible=false;}else{var Temp=document.getElementById('DotNetTextBox_Temp');}Temp.innerHTML='';var dTextRange=document.body.createTextRange();dTextRange.moveToElementText(Temp);dTextRange.collapse(false);dTextRange.execCommand("Paste");var tempData=Temp.innerHTML;Temp.innerHTML='';return tempData;}
function inserMedia(idEdit,url,opw,oph){if(!Error(idEdit))return;var arr=showModalDialog(functionstr+url,null,"dialogWidth:"+opw+"px;dialogHeight:"+oph+"px;status:0;scroll:no");if(!arr)return;idEdit.focus();if(arr[0].toLowerCase().indexOf('http')==-1){arr[0]='http://'+location.host+functionstr+arr[0];}
checkMedia(idEdit,arr);}
function insertTemplate(idEdit,url,opw,oph){if(!Error(idEdit))return;var arr=showModalDialog(functionstr+url,null,"dialogWidth:"+opw+"px;dialogHeight:"+oph+"px;status:0;scroll:no");if(!arr)return;idEdit.focus();sel=idEdit.document.selection.createRange();sel.pasteHTML(arr);}
function inserFile(idEdit,url,opw,oph){if(!Error(idEdit))return;var oSel=GetSelection(idEdit);var el=null;if(oSel.parentElement!=null){el=GetElement(oSel.parentElement(),"A");}
else
el=GetElement(oSel.item(0),"A");if(el){var file=new Array;file[0]=el.href;file[1]=el.innerText;var arr;arr=showModalDialog(functionstr+url,file,"dialogWidth:"+opw+"px;dialogHeight:"+oph+"px;status:0;scroll:no");if(!arr)return;if(arr[0].toLowerCase().indexOf('http')==-1){el.href='http://'+location.host+functionstr+arr[0];}else{el.href=arr[0];}
el.innerText=arr[1];}
else{var arr=showModalDialog(functionstr+url,null,"dialogWidth:"+opw+"px;dialogHeight:"+oph+"px;status:0;scroll:no");if(!arr)return;idEdit.focus();sel=idEdit.document.selection.createRange();var fileurl;if(arr[0].toLowerCase().indexOf('http')==-1){fileurl='http://'+location.host+functionstr+arr[0];}
else{fileurl=arr[0].toLowerCase();}sel.pasteHTML("<a href="+fileurl+">"+arr[1]+"</a>");}}
function create(idEdit,what){if(!Error(idEdit))return;idEdit.focus();idEdit.document.execCommand(what,true,null);}
function specialtype(idEdit,Mark){if(!Error(idEdit))return;var sel,RangeType;sel=idEdit.document.selection.createRange();RangeType=idEdit.document.selection.type;if(RangeType=="Text"&&Mark!="marquee"){sel.pasteHTML("<"+Mark+">"+sel.text+"</"+Mark+">");sel.select();}
else
if(RangeType=="Text"&&Mark=="marquee")
{popupmenu.hide();var speed=showModalDialog(functionstr+"custom.aspx","marquee","dialogWidth:250px;dialogHeight:125px;status:0;scroll:no");if(!speed)return;if(speed!=null){sel.pasteHTML("<marquee behavior=alternate scrollamount="+speed+">"+sel.text+"</marquee>");}
sel.select();}
idEdit.focus();}
function inserTables(idEdit,opw,oph){if(!Error(idEdit))return;var oSel=GetSelection(idEdit);var el=null;if(oSel.parentElement==null){el=GetElement(oSel.item(0),"TABLE");}if(el){var tables=new Array;tables[0]=el.rows.length;tables[1]=el.rows[0].cells.length;tables[2]=el.align;tables[3]=el.border;tables[4]=el.bgColor;tables[5]=el.cellPadding;tables[6]=el.cellSpacing;tables[7]=el.borderColor;tables[8]=el.width;var arr=new Array;arr=showModalDialog(functionstr+"table.aspx",tables,"dialogWidth:"+opw+"pt;dialogHeight:"+oph+"pt;status:0;scroll:no");if(!arr)return;el.cellPadding=arr[0];el.cellSpacing=arr[1];el.border=arr[2];el.width=arr[3];el.borderColor=arr[4];el.bgColor=arr[5];el.align=arr[6];for(var i=el.rows.length;i>arr[7];i--){el.deleteRow();}
for(var i=el.rows[0].cells.length;i>arr[8];i--){for(var j=0;j<el.rows.length;j++){el.rows(j).deleteCell(1);}}
for(var i=el.rows.length;i<arr[7];i++){var elRow=el.insertRow();for(var j=0;j<el.rows[0].cells.length;j++){var elCell=elRow.insertCell();elCell.innerHTML="&nbsp;";}}
for(var i=el.rows[0].cells.length;i<arr[8];i++){for(var j=0;j<el.rows.length;j++){var elCell=el.rows[j].insertCell();elCell.innerHTML="&nbsp;"}}}
else{var arr=showModalDialog(functionstr+"table.aspx",null,"dialogWidth:"+opw+"pt;dialogHeight:"+oph+"pt;status:0;scroll:no");if(!arr)return;inserObject(idEdit,'table',arr);}
idEdit.focus();}
function insertDiv(idEdit,opw,oph){if(!Error(idEdit))return;var oSel=GetSelection(idEdit);var el=null;if(oSel.parentElement!=null){el=GetElement(oSel.parentElement(),"DIV");}
else
el=GetElement(oSel.item(0),"DIV");if(el){var divs=new Array;divs[0]=el.style.width;divs[1]=el.style.height;divs[2]=el.align;divs[3]=el.style.borderWidth;divs[4]=el.style.backgroundColor;divs[5]=el.style.borderColor;divs[6]=el.style.wordBreak;divs[7]=el.style.position;divs[8]=el.style.left;divs[9]=el.style.top;divs[10]=el.style.zIndex;divs[11]=el.style.borderStyle;divs[12]=el.style.overflow;var arr=new Array;arr=showModalDialog(functionstr+"div.aspx",divs,"dialogWidth:"+opw+"pt;dialogHeight:"+oph+"pt;status:0;scroll:no");if(!arr)return;el.style.width=arr[0];el.style.height=arr[1];el.align=arr[2];el.style.borderWidth=arr[3];el.style.backgroundColor=arr[4];el.style.borderColor=arr[5];el.style.wordBreak=arr[6];el.style.position=arr[7];el.style.left=arr[8];el.style.top=arr[9];el.style.zIndex=arr[10];el.style.borderStyle=arr[11];el.style.overflow=arr[12];}
else{var arr=showModalDialog(functionstr+"div.aspx",null,"dialogWidth:"+opw+"pt;dialogHeight:"+oph+"pt;status:0;scroll:no");if(!arr)return;inserObject(idEdit,'div',arr);}
idEdit.focus();}
function openDialog(idEdit,url,opw,oph,type){if(!Error(idEdit))return;var arr=showModalDialog(url,type,"dialogWidth:"+opw+"pt;dialogHeight:"+oph+"pt;status:0;scroll:no");if(arr){switch(type){case'codehighlight':inserObject(idEdit,'codehighlight',arr);break;case'shine':inserObject(idEdit,'shine',arr);break;case'bgcolor':inserObject(idEdit,'bgcolor',arr);break;case'forecolor':format(idEdit,'forecolor',arr);break;default:break;}}
else idEdit.focus();}
function format(idEdit,what,opt){if(!Error(idEdit))return;idEdit.focus();if(what=="fontsize"){inserObject(idEdit,'fontsize',opt);return;}if(opt=="removeFormat"){what=opt;opt=null;}
if(opt=="custom"){opt=showModalDialog(functionstr+"custom.aspx","font","dialogWidth:250px;dialogHeight:125px;status:0;scroll:no");if(!opt)return;}
if(opt==null)idEdit.document.execCommand(what,false,null)
else idEdit.document.execCommand(what,false,opt)}
function checkMedia(idEdit,url){if(!Error(idEdit))return;var afilename,bfilename,filetype;afilename=url[0].split("/");bfilename=afilename[afilename.length-1];filetype=bfilename.split(".");switch(filetype[filetype.length-1].toLowerCase()){case"swf":inserObject(idEdit,'swf',url);break;case"mov":inserObject(idEdit,'qt',url);break;case"asf":inserObject(idEdit,'mp',url);break;case"asx":inserObject(idEdit,'mp',url);break;case"wmv":inserObject(idEdit,'mp',url);break;case"wma":inserObject(idEdit,'music',url);break;case"wmf":inserObject(idEdit,'mp',url);break;case"avi":inserObject(idEdit,'mp',url);break;case"mpeg":inserObject(idEdit,'mp',url);break;case"mpg":inserObject(idEdit,'mp',url);break;case"rm":inserObject(idEdit,'rm',url);break;case"rmvb":inserObject(idEdit,'rm',url);break;case"mp3":inserObject(idEdit,'mp3',url);break;case"mp4":inserObject(idEdit,'music',url);break;case"ra":inserObject(idEdit,'music',url);break;case"wav":inserObject(idEdit,'music',url);break;case"mid":inserObject(idEdit,'music',url);break;case"midi":inserObject(idEdit,'music',url);break;case"flv":inserObject(idEdit,'flv',url);break;default:inserObject(idEdit,'other',url);break;}}
function GetSelection(idEdit)
{var oSel=this.selection;if(!oSel){oSel=idEdit.document.selection.createRange();oSel.type=idEdit.document.selection.type;}
return oSel;}
function GetElement(oEl,sTag)
{while(oEl!=null&&oEl.tagName!=sTag)
oEl=oEl.parentElement;return oEl;}
function plugin_execommand(idEdit,objvalue){if(objvalue!=null&&objvalue!=""){idEdit.focus();sel=idEdit.document.selection.createRange();sel.pasteHTML(objvalue);}
else idEdit.focus();}
function setMode(idEdit,tbid,NewMode,Status,nid){if(NewMode!=eval("EditMode"+nid))
{if(NewMode=="EDIT")
{idEdit.document.body.disabled=false;var temp=(eval("EditMode"+nid)=="SOURCE")?idEdit.document.body.innerText:idEdit.document.body.innerHTML;idEdit.document.designMode="On";idEdit.document.open();idEdit.document.write(sHeader);idEdit.document.body.innerHTML=temp;idEdit.document.close();temp=null;ieSelectionBookmark=null;idEdit.document.onbeforedeactivate=function(){saveBookmark(idEdit)};idEdit.document.onactivate=function(){gotoBookmark(idEdit)};idEdit.document.attachEvent("onclick",popupmenu_hide);idEdit.document.attachEvent("onmouseup",function(e){checkformat(nid)});idEdit.document.attachEvent("onkeyup",function(e){checkformat(nid)});idEdit.document.attachEvent('ondblclick',function(e){dbclickcheck(idEdit)});idEdit.document.oncontextmenu=function(){addmenu(nid);return false;};(newlinemode=="br")?idEdit.document.attachEvent('onkeypress',function(e){insertBr(e,idEdit)}):null;idEdit.document.execCommand('LiveResize',true,true);idEdit.document.execCommand('2D-Position',true,true);}
else
if(NewMode=="SOURCE")
{var temp;if(PathType!='AbsoluteFull'){temp=urlchange(idEdit.document.body.innerHTML);}else{temp=idEdit.document.body.innerHTML;}
(xhtmltype=="client")?temp=getXHtml(temp):null;idEdit.document.designMode="Off";idEdit.document.open();idEdit.document.write(sHeader);idEdit.document.body.scroll="yes";idEdit.document.body.innerText=temp;idEdit.document.body.className="source";idEdit.document.close();temp=null;idEdit.document.attachEvent('onkeypress',function(e){insertBr(e,idEdit)});idEdit.document.oncontextmenu=function(){return true}
if(!sourcestr){idEdit.document.body.disabled=true;idEdit.document.body.contentEditable?idEdit.document.body.contentEditable=false:idEdit.document.designMode='off';}}
else if(NewMode=="VIEW")
{if(eval("EditMode"+nid)=="SOURCE"){var temp=idEdit.document.body.textContent?idEdit.document.body.textContent:idEdit.document.body.innerText;}else{var temp=idEdit.document.body.innerHTML;}
idEdit.document.open();idEdit.document.write(sHeader2+temp);idEdit.document.close();idEdit.document.designMode="off";}
bMode=Status;eval("EditMode"+nid+"=NewMode");for(var i=0;i<tbid.children.length;i++)
tbid.children[i].disabled=(!bMode);}
idEdit.focus();}
function insertBr(e,idEdit){if(e.keyCode==13){var rng=idEdit.document.selection.createRange();if(!GetElement(rng.parentElement(),"LI")){rng.pasteHTML("<BR />");rng.moveStart('character',0);rng.collapse(true);rng.select();e.cancelBubble=true;e.returnValue=false;return false;}else{return true;}}}
function saveBookmark(obj){var range=obj.document.selection.createRange();if(obj.document.selection.type!="Control"){ieSelectionBookmark=range.getBookmark();}else{ieSelectionBookmark=range.item(0);}}
function gotoBookmark(obj){if(ieSelectionBookmark){var range=obj.document.body.createTextRange();if(ieSelectionBookmark!="[object]")
{range.moveToBookmark(ieSelectionBookmark);}
else
{range.moveToElementText(ieSelectionBookmark);}
range.select();ieSelectionBookmark=null;}}
var history=new Object;history.data=[];history.position=0;history.bookmark=[];initVar();function initVar()
{history.data.length=0;history.bookmark.length=0;history.position=0;}
function saveUndoRedo(idEdit){if(bMode){if(history.data[history.position]!=idEdit.document.body.innerHTML){var nBeginLen=history.data.length;var nPopLen=history.data.length-history.position;for(var i=1;i<nPopLen;i++){history.data.pop();history.bookmark.pop();}
history.data[history.data.length]=idEdit.document.body.innerHTML;if(idEdit.document.selection.type!="Control"){history.bookmark[history.bookmark.length]=idEdit.document.selection.createRange().getBookmark();}else{var oControl=idEdit.document.selection.createRange();history.bookmark[history.bookmark.length]=oControl[0];}
if(nBeginLen!=0){history.position++;}}}}
function goUndoRedo(value,idEdit){if(bMode){saveUndoRedo(idEdit);if(value==-1){if(history.position>0){idEdit.document.body.innerHTML=history.data[--history.position];applyUndoRedo(idEdit);}}else{if(history.position<history.data.length-1){idEdit.document.body.innerHTML=history.data[++history.position];applyUndoRedo(idEdit);}}}}
function applyUndoRedo(idEdit){if(history.bookmark[history.position]){r=idEdit.document.body.createTextRange();if(history.bookmark[history.position]!="[object]"){if(r.moveToBookmark(history.bookmark[history.position])){r.collapse(false);r.select();}}}}
function executeUndoRedo(idEdit){if(bMode){saveUndoRedo(idEdit);}}
function inserImg(idEdit,url,opw,oph){if(!Error(idEdit))return;var oSel=GetSelection(idEdit);var el=null;if(oSel.parentElement!=null){el=GetElement(oSel.parentElement(),"IMG");}
else
el=GetElement(oSel.item(0),"IMG");if(el){var image=new Array;image[0]=el.width;image[1]=el.height;image[2]=el.alt;image[3]=el.src;if(!el.align)
{image[4]='';}
else{image[4]=el.align;}image[5]=el.vspace;image[6]=el.hspace;var arr=new Array;arr=showModalDialog(functionstr+url,image,"dialogWidth:"+opw+"px;dialogHeight:"+oph+"px;status:0;scroll:no");if(!arr)return;if(arr[0].toLowerCase().indexOf('http')==-1){el.src='http://'+location.host+functionstr+arr[0];}else{el.src=arr[0];}
el.width=arr[1];el.height=arr[2];el.alt=arr[3];el.align=arr[4];el.vspace=arr[5];el.hspace=arr[6];}
else{var arr=showModalDialog(functionstr+url,null,"dialogWidth:"+opw+"px;dialogHeight:"+oph+"px;status:0;scroll:no");if(!arr)return;idEdit.focus();sel=idEdit.document.selection.createRange();var imgurl;if(arr[0].toLowerCase().indexOf('http')==-1){imgurl='http://'+location.host+functionstr+arr[0];}
else{imgurl=arr[0];}arr[1]=arr[1]?" width='"+arr[1]+"' ":" ";arr[2]=arr[2]?"height='"+arr[2]+"' ":"";arr[3]=arr[3]?"alt='"+arr[3]+"' ":"";arr[4]="align='"+arr[4]+"' ";arr[5]="vspace='"+arr[5]+"' ";arr[6]="hspace='"+arr[6]+"' ";sel.pasteHTML("<img src="+imgurl+arr[1]+arr[2]+arr[3]+arr[4]+arr[5]+arr[6]+">");if(getimagespathid!=""){document.getElementById(getimagespathid).value=imgurl;}}}
function insertlink(idEdit,url,opw,oph){if(!Error(idEdit))return;var oSel=GetSelection(idEdit);var el=null;if(oSel.parentElement!=null){el=GetElement(oSel.parentElement(),"A");}
else
el=GetElement(oSel.item(0),"A");if(el){var link=new Array;link[0]=el.href;link[1]=el.target;var arr=showModalDialog(functionstr+url,link,"dialogWidth:"+opw+"px;dialogHeight:"+oph+"px;status:0;scroll:no");if(!arr)return;el.href=arr[0];el.target=arr[1];}
else{var arr=showModalDialog(functionstr+url,null,"dialogWidth:"+opw+"px;dialogHeight:"+oph+"px;status:0;scroll:no");if(!arr)return;idEdit.focus();sel=idEdit.document.selection.createRange();if(idEdit.document.selection.type=='Text'){var linktext=sel.text;}else if(idEdit.document.selection.type=='Control'){var linktext=sel.item(0).outerHTML;sel.execCommand('Delete');sel=idEdit.document.selection.createRange();}else{var linktext=arr[0];}
if(arr[1]!=''){sel.pasteHTML("<a href="+arr[0]+" target="+arr[1]+">"+linktext+"</a>");}else{sel.pasteHTML("<a href="+arr[0]+">"+linktext+"</a>");}}}
function inserObject(idEdit,obj,objvalue){if(!Error(idEdit))return;idEdit.focus();sel=idEdit.document.selection.createRange();switch(obj){case"fontsize":oSel=GetSelection(idEdit);var el=null;if(oSel.parentElement!=null){el=GetElement(oSel.parentElement(),"SPAN")}else{el=GetElement(oSel.item(0),"SPAN")};if(el){el.style.fontSize=objvalue;}else{sel.pasteHTML("<span style='font-size:"+objvalue+"'>"+sel.htmlText+"</span>");}break;case"shine":if(idEdit.document.selection.type=="Text"){sel.pasteHTML("<FIELDSET style='FILTER: glow(color="+objvalue+",strength=3);COLOR: #ffffff;BORDER-RIGHT: 0px; BORDER-TOP: 0px; DISPLAY: inline;BORDER-LEFT: 0px; PADDING-TOP: 3px; BORDER-BOTTOM: 0px'>"+sel.text+"</FIELDSET>");}
break;case"link":if(!objvalue)return;if(idEdit.document.selection.type=='Text'){var linktext=sel.text;}else if(idEdit.document.selection.type=='Control'){var linktext=sel.item(0).outerHTML;sel.execCommand('Delete');sel=idEdit.document.selection.createRange();}else{var linktext=objvalue[0];}
if(objvalue[1]!=''){sel.pasteHTML("<a href="+objvalue[0]+" target="+objvalue[1]+">"+linktext+"</a>");}else{sel.pasteHTML("<a href="+objvalue[0]+">"+linktext+"</a>");}
break;case"editlink":if(!objvalue)return;var oSel=GetSelection(idEdit);var el=null;if(oSel.parentElement!=null){el=GetElement(oSel.parentElement(),"A");}
else
el=GetElement(oSel.item(0),"A");el.href=objvalue[0];el.target=objvalue[1];break;case"pagebreak":sel.pasteHTML("<div title=\"Print Page Break\" style=\"font-size: 1px; page-break-before: always; vertical-align: middle; height: 1px; background-color: #c0c0c0\">&nbsp;</div>");break;case"pageoutput":sel.pasteHTML("<hr id=pageoutput/>");break;case"table":sel.pasteHTML(objvalue);break;case"codehighlight":sel.pasteHTML(objvalue);break;case"div":sel.pasteHTML(objvalue);break;case"excel":sel.pasteHTML("<object classid='clsid:0002E510-0000-0000-C000-000000000046' id='Spreadsheet1' codebase='msowc.cab' width='100%' height='250'><param name='HTMLURL' value><param name='HTMLData' value='&lt;html xmlns:x=&quot;urn:schemas-microsoft-com:office:excel&quot;xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;&lt;head&gt;&lt;style type=&quot;text/css&quot;&gt;&lt;!--tr{mso-height-source:auto;}td{black-space:nowrap;}.wc4590F88{black-space:nowrap;font-family:ו;mso-number-format:General;font-size:auto;font-weight:auto;font-style:auto;text-decoration:auto;mso-background-source:auto;mso-pattern:auto;mso-color-source:auto;text-align:general;vertical-align:bottom;border-top:none;border-left:none;border-right:none;border-bottom:none;mso-protection:locked;}--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;&lt;x:ExcelWorkbook&gt;&lt;x:ExcelWorksheets&gt;&lt;x:ExcelWorksheet&gt;&lt;x:OWCVersion&gt;9.0.0.2710&lt;/x:OWCVersion&gt;&lt;x:Label Style='border-top:solid .5pt silver;border-left:solid .5pt silver;border-right:solid .5pt silver;border-bottom:solid .5pt silver'&gt;&lt;x:Caption&gt;Microsoft Office Spreadsheet&lt;/x:Caption&gt; &lt;/x:Label&gt;&lt;x:Name&gt;Sheet1&lt;/x:Name&gt;&lt;x:WorksheetOptions&gt;&lt;x:Selected/&gt;&lt;x:Height&gt;7620&lt;/x:Height&gt;"+"&lt;x:Width&gt;15240&lt;/x:Width&gt;&lt;x:TopRowVisible&gt;0&lt;/x:TopRowVisible&gt;&lt;x:LeftColumnVisible&gt;0&lt;/x:LeftColumnVisible&gt; &lt;x:ProtectContents&gt;False&lt;/x:ProtectContents&gt; &lt;x:DefaultRowHeight&gt;210&lt;/x:DefaultRowHeight&gt; &lt;x:StandardWidth&gt;2389&lt;/x:StandardWidth&gt; &lt;/x:WorksheetOptions&gt; &lt;/x:ExcelWorksheet&gt;&lt;/x:ExcelWorksheets&gt; &lt;x:MaxHeight&gt;80%&lt;/x:MaxHeight&gt;&lt;x:MaxWidth&gt;80%&lt;/x:MaxWidth&gt;&lt;/x:ExcelWorkbook&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;table class=wc4590F88 x:str&gt;&lt;col width=&quot;56&quot;&gt;&lt;tr height=&quot;14&quot;&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;'> <param name='DataType' value='HTMLDATA'> <param name='AutoFit' value='0'><param name='DisplayColHeaders' value='-1'><param name='DisplayGridlines' value='-1'><param name='DisplayHorizontalScrollBar' value='-1'><param name='DisplayRowHeaders' value='-1'><param name='DisplayTitleBar' value='-1'><param name='DisplayToolbar' value='-1'><param name='DisplayVerticalScrollBar' value='-1'> <param name='EnableAutoCalculate' value='-1'> <param name='EnableEvents' value='-1'><param name='MoveAfterReturn' value='-1'><param name='MoveAfterReturnDirection' value='0'><param name='RightToLeft' value='0'><param name='ViewableRange' value='1:65536'></object>");break;case"nowdate":sel.pasteHTML(objvalue);break;case"nowtime":var d=new Date();sel.pasteHTML(d.toLocaleTimeString());break;case"swf":if(!objvalue)return;sel.pasteHTML("<OBJECT classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000' codebase='http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0' width="+objvalue[1]+" height="+objvalue[2]+"><PARAM NAME=movie VALUE="+objvalue[0]+"><PARAM NAME=quality VALUE=high><embed src=\""+objvalue[0]+"\" quality=high pluginspage='http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash' type='application/x-shockwave-flash' width="+objvalue[1]+" height="+objvalue[2]+"></embed></OBJECT>");break;case"rm":if(!objvalue)return;sel.pasteHTML("<OBJECT classid=CLSID:CFCDAA03-8BE4-11CF-B84B-0020AFBBCCFA class=OBJECT id=RAOCX width="+objvalue[1]+" height="+objvalue[2]+"><PARAM NAME=SRC VALUE="+objvalue[0]+"><PARAM NAME=CONSOLE VALUE=Clip1><PARAM NAME=CONTROLS VALUE=imagewindow><PARAM NAME='loop' VALUE="+objvalue[4]+"></OBJECT><br /><OBJECT classid=CLSID:CFCDAA03-8BE4-11CF-B84B-0020AFBBCCFA height=32 id=video2 width="+objvalue[1]+"><PARAM name=src value="+objvalue[0]+"><PARAM NAME=AUTOSTART VALUE=-1><PARAM NAME=CONTROLS VALUE=controlpanel><PARAM NAME=CONSOLE VALUE=Clip1></OBJECT>");break;case"music":if(!objvalue)return;sel.pasteHTML("<object class='OBJECT' id=MediaPlayer width='"+objvalue[1]+"' height='"+objvalue[2]+"' classid='clsid:6BF52A52-394A-11D3-B153-00C04F79FAA6'><param name=url value='"+objvalue[0]+"'><PARAM NAME='volume' value="+objvalue[3]+"><embed type=application/x-oleobject codebase=http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701 flename=mp src='"+objvalue[0]+"' width='"+objvalue[1]+"' loop="+objvalue[4]+" height='"+objvalue[2]+"'></embed></object>");break;case"mp":if(!objvalue)return;sel=idEdit.document.selection.createRange();sel.pasteHTML("<object class='OBJECT' id=MediaPlayer width='"+objvalue[1]+"' height='"+objvalue[2]+"' classid='clsid:6BF52A52-394A-11D3-B153-00C04F79FAA6'><param name=url value='"+objvalue[0]+"'><embed type=application/x-oleobject codebase=http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701 flename=mp src='"+objvalue[0]+"' loop="+objvalue[4]+" width='"+objvalue[1]+"' height='"+objvalue[2]+"'></embed></object>");break;case"flv":if(!objvalue)return;sel.pasteHTML("<embed src='"+functionstr+"flv.swf?file="+objvalue[0]+"&autostart=true' pluginspage='http://www.macromedia.com/go/getflashplayer\' type='application/x-shockwave-flash' wmode='transparent' quality='high' allowfullscreen='true' width='"+objvalue[1]+"' height='"+objvalue[2]+"'>");break;case"mp3":if(!objvalue)return;sel.pasteHTML("<embed wmode='transparent' width="+objvalue[1]+" height="+objvalue[2]+" src='"+functionstr+"mp3player.swf?file="+objvalue[0]+"&autoStart=true&backColor=000000&frontColor=ffffff&songVolume=90' type='application/x-shockwave-flash' pluginspage='http://www.macromedia.com/go/getflashplayer'/>");break;case"qt":if(!objvalue)return;sel.pasteHTML("<embed src="+objvalue[0]+" width="+objvalue[1]+" height="+objvalue[2]+" autoplay=true loop="+objvalue[4]+"  controller=true playeveryframe=false cache=false scale=TOFIT bgcolor=#000000 kioskmode=false targetcache=false pluginspage=http://www.apple.com/quicktime/>");break;case"other":if(!objvalue)return;sel.pasteHTML("<EMBED src="+objvalue[0]+" width="+objvalue[1]+" height="+objvalue[2]+" autostart=true loop="+objvalue[4]+">");break;case"emot":if(!objvalue)return;if(idEdit.document.selection.type!='None'){sel.execCommand('Delete');sel=idEdit.document.selection.createRange();}
sel.pasteHTML("<IMG SRC='"+objvalue+"'>");break;case"symbol":if(!objvalue)return;if(idEdit.document.selection.type!='None'){sel.execCommand('Delete');sel=idEdit.document.selection.createRange();}
sel.pasteHTML(objvalue);break;case"bgcolor":if(!objvalue)return;var oSel=GetSelection(idEdit);var el=null;if(oSel.parentElement!=null){el=GetElement(oSel.parentElement(),"TD");if(!el)el=GetElement(oSel.parentElement(),"TH");if(!el)el=GetElement(oSel.parentElement(),"TR");if(!el)el=GetElement(oSel.parentElement(),"TABLE");}
else
el=GetElement(oSel.item(0),"TABLE");if(el)
el.bgColor=objvalue;else
idEdit.document.execCommand('backcolor','',objvalue);break;case"getpage":if(!objvalue)return;sel.pasteHTML(objvalue);break;case"code":RangeType=idEdit.document.selection.type;if(RangeType=="Text"){sel.pasteHTML('<table width=95% border="0" align="Center" cellpadding="6" cellspacing="0" style="border: 1px Dotted #6595d6; TABLE-LAYOUT: fixed"><tr><td bgcolor=#e8f4ff style="WORD-WRAP: break-word"><font style="color: #990000;font-weight:bold">'+codetitle+'</font><br />'+sel.text+'</td></tr></table>');}
break;case"quote":RangeType=idEdit.document.selection.type;if(RangeType=="Text"){sel.pasteHTML('<table width=95% border="0" align="Center" cellpadding="6" cellspacing="0" style="border: 1px Dotted #6595d6; TABLE-LAYOUT: fixed"><tr><td bgcolor=#e8f4ff style="WORD-WRAP: break-word"><font style="color: #990000;font-weight:bold">'+quotetitle+'</font><br />'+sel.text+'</td></tr></table>');}
break;case"sub":RangeType=idEdit.document.selection.type;if(RangeType=="Text"){sel.pasteHTML('<sub>'+sel.text+'</sub>');}
case"sup":RangeType=idEdit.document.selection.type;if(RangeType=="Text"){sel.pasteHTML('<sup>'+sel.text+'</sup>');}
break;case"msn":sel.pasteHTML("<a href='msnim:chat?contact="+objvalue+"' target=blank><img alt='"+msncheck+"' style='border-style: none;' src='http://messenger.services.live.com/users/"+objvalue+"/presenceimage?mkt=zh-cn' width='16' height='16' /></a>");break;case"icq":sel.pasteHTML("<a target=_blank href=http://wwp.icq.com/scripts/search.dll?to="+objvalue+"><img border=0 align=absmiddle src=http://web.icq.com/whitepages/online?icq="+objvalue+"&img=5 alt="+icqcheck+" /></a>");break;case"qq":sel.pasteHTML("<a target=blank href=tencent://message/?uin="+objvalue[0]+"&Site=N&Menu=yes><img border=0 alt='"+sendmsg+"' src=http://wpa.qq.com/pa?p=1:"+objvalue[0]+":"+objvalue[1]+"></a>");break;case"calculator":sel.pasteHTML(objvalue);break;default:alert(errorparameter);break;}
sel=null;}
function formatstripper(idEdit,type)
{if(!Error(idEdit))return;if(idEdit.document.selection.type.toLowerCase()!="text")
{idEdit.document.body.innerHTML=cleanCode(idEdit.document.body.innerHTML,type);}
else
{var oSel=idEdit.document.selection.createRange();var htmltext=cleanCode(oSel.htmlText,type);idEdit.document.selection.clear();if(oSel.parentElement().tagName.toLowerCase()!="body")
{oSel.parentElement().removeNode(true);}
oSel.pasteHTML(htmltext);}
alert(cleancodesuccessful);}
getXHtml=function(str){return str.replace(/<[^<>]+>/gm,function(nodeHtml){if(nodeHtml.indexOf("/>")>-1||nodeHtml.indexOf("</")>-1){return nodeHtml.toLowerCase();}
nodeHtml=nodeHtml.replace(/\w+="{1}[^"]*"{1}/gm,function(nodeAtt){var arr=nodeAtt.split('="');var attValue=arr[1].substr(0,arr[1].length-1);attValue=xmlEscape(attValue);return arr[0].toLowerCase()+'="'+attValue+'"';});nodeHtml=nodeHtml.replace(/ \w+=[^"> ]+/gm,function(nodeAtt){var n=nodeAtt.indexOf('=');var attName=nodeAtt.substring(0,n+1);var attValue=nodeAtt.substr(n+1);attValue=xmlEscape(attValue);return attName.toLowerCase()+'"'+attValue+'"';});var nodeName;nodeHtml=nodeHtml.replace(/<\w+/gm,function(nn){nn=nn.toLowerCase();nodeName=nn.substr(1);return nn;});if(nodeName=="input"||nodeName=="hr"||nodeName=="br"||nodeName=="img"){if(nodeHtml.substr(nodeHtml.length-2)!="/>"){nodeHtml=nodeHtml.substr(0,nodeHtml.length-1)+"/>";}}
return nodeHtml;});}
function xmlEscape(text)
{text=text.replace(/</g,"&lt;");text=text.replace(/>/g,"&gt;");return text;}