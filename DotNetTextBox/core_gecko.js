var opera=(navigator.userAgent.toLowerCase().indexOf('opera')!=-1),sel=null,EditMode="EDIT";function buildDiv(tid,url,w,h,divid){if(document.getElementById(divid)==null){if(divid.indexOf("qq")!=-1||divid.indexOf("msn")!=-1||divid.indexOf("icq")!=-1||divid.indexOf("getpage")!=-1){w=w+50;h=h+20;}var popMenu2=new dhLayer(window,"popupmenu_popup");popMenu2.id=divid;switch(divid)
{case tid+"_popup_fontname_menu":var content="<TABLE border=0 cellPadding=4 cellSpacing=0 unselectable=\"on\"><TBODY><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'simsun')\" unselectable=\"on\"><FONT face='simsun' unselectable=\"on\">"+simsun+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname','SimHei')\" unselectable=\"on\"><FONT face='simhei' unselectable=\"on\">"+simhei+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'LiSu')\" unselectable=\"on\"><FONT face='LiSu' unselectable=\"on\">"+stliti+"</FONT></TD></TR>";content+="<TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'YouYuan')\" unselectable=\"on\"><FONT face='YouYuan' unselectable=\"on\">"+simyou+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'KaiTi_GB2312')\" unselectable=\"on\"><FONT face='KaiTi_GB2312' unselectable=\"on\">"+simkai+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'FangSong_GB2312')\" unselectable=\"on\"><FONT face='FangSong_GB2312' unselectable=\"on\">"+simfang+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'NSimSun')\" unselectable=\"on\"><FONT face='NSimSun' unselectable=\"on\">"+newsimsun+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'STCaiyun')\" unselectable=\"on\"><FONT face='STCaiyun' unselectable=\"on\">"+stcaiyun+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'STFangsong')\" unselectable=\"on\"><FONT face='STFangsong' unselectable=\"on\">"+stfangso+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'stxinwei')\" unselectable=\"on\">";content+="<FONT face='stxinwei' unselectable=\"on\">"+stxinwei+"</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Arial')\" unselectable=\"on\"><FONT face=\"Arial\" unselectable=\"on\">Arial</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Arial Black')\" unselectable=\"on\"><FONT face=\"Arial Black\" unselectable=\"on\">Arial Black</FONT></TD>";content+="</TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Arial Narrow')\" unselectable=\"on\"><FONT face=\"Arial Narrow\" unselectable=\"on\">Arial Narrow</FONT></TD>";content+="</TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Century')\" unselectable=\"on\"><FONT face=\"Century\" unselectable=\"on\">Century</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Courier New')\" unselectable=\"on\"><FONT face=\"Courier New\" unselectable=\"on\">Courier New</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Georgia')\" unselectable=\"on\"><FONT face=\"Georgia\" unselectable=\"on\">Georgia</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Impact')\" unselectable=\"on\"><FONT face=\"Impact\" unselectable=\"on\">Impact</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Lucida Console')\" unselectable=\"on\"><FONT face=\"Lucida Console\" unselectable=\"on\">Lucida Console</FONT></TD>";content+="</TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'MS Sans Serif')\" unselectable=\"on\"><FONT face=\"MS Sans Serif\" unselectable=\"on\">MS Sans Serif</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'System')\" unselectable=\"on\"><FONT face=\"System\" unselectable=\"on\">System</FONT></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Symbol')\" unselectable=\"on\">Symbol</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Tahoma')\" unselectable=\"on\"><FONT face=\"Tahoma\" unselectable=\"on\">Tahoma</FONT></TD>";content+="</TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Times New Roman')\" unselectable=\"on\"><FONT face=\"Times New Roman\" unselectable=\"on\">Times New Roman</FONT></TD>";content+="</TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Verdana')\" unselectable=\"on\"><FONT face=\"Verdana\" unselectable=\"on\">Verdana</FONT></TD>";content+="</TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Webdings')\" unselectable=\"on\">Webdings</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Wingdings')\" unselectable=\"on\">Wingdings</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'Webdings')\" unselectable=\"on\">Webdings</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontname', 'custom')\" unselectable=\"on\">"+custom+"</TD></TR></TBODY></TABLE>";popMenu2.content=content;break;case tid+"_popup_emot_menu":popMenu2.content="<iframe width="+w+" height="+h+" scrolling=no frameBorder=0 src='"+url+"emot.aspx?name=dntb_"+tid+"'></iframe>";break;case tid+"_popup_fontsize_menu":popMenu2.content="<TABLE cellSpacing=0 cellPadding=4 border=0 unselectable=\"on\" width="+w+" height="+h+"><TBODY><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize', 1)\" unselectable=\"on\"><FONT size=1 unselectable=\"on\">1</FONT></TD></TR><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize', 2)\" unselectable=\"on\"><FONT size=2 unselectable=\"on\">2</FONT></TD></TR><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize', 3)\" unselectable=\"on\"><FONT size=3 unselectable=\"on\">3</FONT></TD></TR><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize', 4)\" unselectable=\"on\"><FONT size=4 unselectable=\"on\">4</FONT></TD></TR><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize', 5)\" unselectable=\"on\"><FONT size=5 unselectable=\"on\">5</FONT></TD></TR><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize', 6)\" unselectable=\"on\"><FONT size=6 unselectable=\"on\">6</FONT></TD></TR><TR align=middle><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'fontsize', 7)\" unselectable=\"on\"><FONT size=7 unselectable=\"on\">7</FONT></TD></TR></TBODY></TABLE>";break;case tid+"_popup_paragraph_menu":popMenu2.content="<TABLE border=0 cellspacing=\"0px\" width="+w+" height="+h+" unselectable=\"on\"><TBODY><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<P>')\" unselectable=\"on\">"+normal+"</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<H1>')\"><h1 unselectable=\"on\">"+h1+"</h1></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<H2>')\"><h2 unselectable=\"on\">"+h2+"</h2></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<H3>')\"><h3 unselectable=\"on\">"+h3+"</h3></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<H4>')\"><h4 unselectable=\"on\">"+h4+"</h4></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<H5>')\"><h5 unselectable=\"on\">"+h5+"</h5></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<H6>')\"><h6 unselectable=\"on\">"+h6+"</h6></TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<p>')\" unselectable=\"on\">"+paragraph+"</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<dd>')\" unselectable=\"on\">"+dd+"</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<dt>')\" unselectable=\"on\">"+dt+"</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<dir>')\" unselectable=\"on\">"+dirlist+"</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<menu>')\" unselectable=\"on\">"+menulist+"</TD></TR><TR><TD class=popupmenu_option onClick=\"format(dntb_"+tid+",'formatblock', '<PRE>')\" unselectable=\"on\">"+pre+"</TD></TR></TBODY></TABLE>";break;case tid+"_popup_specialtype_menu":if(opera)
{marquee="<MARQUEE scrollAmount=\"3\" behavior=\"alternate\" style=\"cursor:pointer\" unselectable=\"on\">"+marquee+"</MARQUEE>";}
popMenu2.content="<TABLE border=0 cellspacing=\"0px\"  width="+w+" height="+h+"  unselectable=\"on\"><TBODY><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'sup')\" unselectable=\"on\">X<Sup>2</Sup></TD></TR><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'sub')\" unselectable=\"on\">X<Sub>2</Sub></TD></TR><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'address')\"><ADDRESS  unselectable=\"on\">"+address+"</ADDRESS></TD></TR><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'blink')\" unselectable=\"on\"><BLINK>"+blink+"</BLINK></TD></TR><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'marquee')\">"+marquee+"</TD></TR><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'del')\"><del unselectable=\"on\">"+delline+"<del></TD></TR><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'big')\" unselectable=\"on\">"+big+"</TD></TR><TR><TD class=popupmenu_option onClick=\"specialtype(dntb_"+tid+",'small')\" unselectable=\"on\">"+small+"</TD></TR></TBODY></TABLE>";break;case tid+"_popup_formatstripper_menu":popMenu2.content="<TABLE cellspacing=\"0px\" cellPadding=4 border=0 unselectable=\"on\" width="+w+" height="+h+"><TBODY><TR><TD class=popupmenu_option onClick=\"formatstripper(dntb_"+tid+",'html')\" unselectable=\"on\">"+delhtmltag+"</TD></TR><TR><TD class=popupmenu_option onClick=\"formatstripper(dntb_"+tid+",'word')\" unselectable=\"on\">"+delwordtag+"</TD></TR><TR><TD class=popupmenu_option onClick=\"formatstripper(dntb_"+tid+",'style')\" unselectable=\"on\">"+delstyletag+"</TD></TR><TR><TD class=popupmenu_option onClick=\"formatstripper(dntb_"+tid+",'font')\" unselectable=\"on\">"+delfonttag+"</TD></TR><TR><TD class=popupmenu_option onClick=\"formatstripper(dntb_"+tid+",'span')\" unselectable=\"on\">"+delspantag+"</TD></TR></TBODY></TABLE>";break;default:popMenu2.content="<iframe width="+w+" height="+h+" scrolling=no frameBorder=0 src='"+functionstr+url+".aspx?name=dntb_"+tid+"&type="+divid+"'></iframe>";break;}popMenu2.show(w,h,document.body);}}
var tid='WebEditor1';window.constructor.prototype.__defineGetter__("event",function(){for(var o=arguments.callee.caller,e=null;o!=null;o=o.caller){e=o.arguments[0];if(e&&(e instanceof Event))
return e;}
return null;});if(!opera){;HTMLElement.prototype.__defineGetter__("children",function(){var returnValue=new Object();var number=0;for(var i=0;i<this.childNodes.length;i++){if(this.childNodes[i].nodeType==1){returnValue[number]=this.childNodes[i];number++;}}
returnValue.length=number;return returnValue;});}function pasterTag(objvalue){var idEdit=document.getElementById("dntb_"+tid).contentWindow;var fragment=idEdit.document.createDocumentFragment();var holder=idEdit.document.createElement('span');holder.innerHTML=objvalue;while(holder.firstChild){fragment.appendChild(holder.firstChild);}insertNodeAtSelection(fragment,idEdit);}
function colordialog(type,obj,divid){var e=event.srcElement?event.srcElement:event.target;e.onkeyup=colordialog;var oSel=GetSelection(document.getElementById('dntb_'+obj).contentWindow);var el=null,nowcolor=null;if(type!='bgcolor'){el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"SPAN");if(!el)el=GetElement(oSel.startContainer,"SPAN");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"A");if(!el)el=GetElement(oSel.startContainer,"A");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"FONT");if(!el)el=GetElement(oSel.startContainer,"FONT");if(!el){nowcolor='#FFFFFF';}else{nowcolor=el.style.color?el.style.color:el.color;}}else{el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TD");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TH");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TR");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TABLE");if(!el)el=GetElement(oSel.startContainer,"TABLE");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"A");if(!el)el=GetElement(oSel.startContainer,"A");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"SPAN");if(!el)el=GetElement(oSel.startContainer,"SPAN");if(!el){nowcolor='#FFFFFF';}else{nowcolor=el.bgColor?el.bgColor:el.style.backgroundColor;}}var ocbody;var colorlist=new Array(40);popMenu.id=divid;colorlist[0]="#000000";colorlist[1]="#993300";colorlist[2]="#333300";colorlist[3]="#003300";colorlist[4]="#003366";colorlist[5]="#000080";colorlist[6]="#333399";colorlist[7]="#333333";colorlist[8]="#800000";colorlist[9]="#FF6600";colorlist[10]="#808000";colorlist[11]="#008000";colorlist[12]="#008080";colorlist[13]="#0000FF";colorlist[14]="#666699";colorlist[15]="#808080";colorlist[16]="#FF0000";colorlist[17]="#FF9900";colorlist[18]="#99CC00";colorlist[19]="#339966";colorlist[20]="#33CCCC";colorlist[21]="#3366FF";colorlist[22]="#800080";colorlist[23]="#999999";colorlist[24]="#FF00FF";colorlist[25]="#FFCC00";colorlist[26]="#FFFF00";colorlist[27]="#00FF00";colorlist[28]="#00FFFF";colorlist[29]="#00CCFF";colorlist[30]="#993366";colorlist[31]="#CCCCCC";colorlist[32]="#FF99CC";colorlist[33]="#FFCC99";colorlist[34]="#FFFF99";colorlist[35]="#CCFFCC";colorlist[36]="#CCFFFF";colorlist[37]="#99CCFF";colorlist[38]="#CC99FF";colorlist[39]="#FFFFFF";ocbody="";ocbody+="<table CELLPADDING=0 CELLSPACING=3>";ocbody+="<tr height='20' width='20'><td align='center'><table style='border:1px solid #808080;background-color:"+nowcolor+"' width='12' height='12'><tr><td></td></tr></table></td><td bgcolor='eeeeee' colspan='7' style='font-size:12px;' align='center'>"+nowcolorstr+"</td></tr>";for(var i=0;i<colorlist.length;i++){if(i%8==0)
ocbody+="<tr>";ocbody+="<td width='14' height='16' style='border:1px solid;' onMouseOut='colordialogmouseout(this);' onMouseOver='colordialogmouseover(this);' onMouseDown='colordialogmousedown(\""+colorlist[i]+"\",\""+type+"\",\""+obj+"\")' align='center' valign='middle'><table style='border:1px solid #808080;' width='12' height='12' bgcolor='"+colorlist[i]+"'><tr><td></td></tr></table></td>";if(i%8==7)
ocbody+="</tr>";}
ocbody+="<tr><td align='center' height='22' colspan='8' onMouseOut='colordialogmouseout(this);' onMouseOver='colordialogmouseover(this);' style='border:1px solid;font-size:12px;cursor:default;' unselectable='on' onclick='popupmenu.hide();openDialog(dntb_"+obj+",\""+functionstr+"color.aspx\",\"230\",\"200\",\""+type+"\")'>"+customcolorstr+"</td></tr>";ocbody+="</table>";popMenu.content=ocbody;popMenu.show(158,147,document.body);}
function pasteContent(idEdit){if(document.getElementById('copytemp')){var sText=document.getElementById('copytemp').innerHTML;}else{return;}pasterTag(sText);idEdit.focus();}
function pastetext(idEdit){if(document.getElementById('copytemp')){var sText=document.getElementById('copytemp').textContent;}else{return;}pasterTag(sText);idEdit.focus();}
function pasteword(idEdit){if(document.getElementById('copytemp')){var sText=document.getElementById('copytemp').innerHTML;}else{return;}var re=/<\w[^>]*class="?MsoNormal"?/gi;idEdit.focus();if(re.test(sText)){if(confirm(removedwordformat)){sText=cleanCode(sText,"word");}}
pasterTag(sText);idEdit.focus();}
function copycontent(idEdit){if(!document.getElementById('copytemp')){var divholder=document.createElement('div');divholder.id='copytemp';divholder.style.display='none';document.body.appendChild(divholder);}
document.getElementById('copytemp').innerHTML='';document.getElementById('copytemp').innerHTML=readNodes(GetSelection(idEdit).cloneContents(),false);}
function cutcontent(idEdit){if(!document.getElementById('copytemp')){var divholder=document.createElement('div');divholder.id='copytemp';divholder.style.display='none';document.body.appendChild(divholder);}
document.getElementById('copytemp').innerHTML='';document.getElementById('copytemp').innerHTML=readNodes(GetSelection(idEdit).cloneContents(),false);GetSelection(idEdit).deleteContents();}
function readNodes(root,toptag){var html="";var moz_check=/_moz/i;switch(root.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:var closed;if(toptag){closed=!root.hasChildNodes();html='<'+root.tagName.toLowerCase();var attr=root.attributes;for(var i=0;i<attr.length;++i){var a=attr.item(i);if(!a.specified||a.name.match(moz_check)||a.value.match(moz_check)){continue;}
html+=" "+a.name.toLowerCase()+'="'+a.value+'"';}
html+=closed?" />":">";}
for(var i=root.firstChild;i;i=i.nextSibling){html+=readNodes(i,true);}
if(toptag&&!closed){html+="</"+root.tagName.toLowerCase()+">";}
break;case Node.TEXT_NODE:html=root.data;break;}
return html;}
function inserMedia(idEdit,url,opw,oph){if(!Error(idEdit))return;window.open(functionstr+url,null,"modal=yes,width="+opw*1.2+",height="+oph+",resizable=no,scrollbars=yes,status=no");}
function inserFile(idEdit,url,opw,oph){if(!Error(idEdit))return;window.open(functionstr+url,null,"modal=yes,width="+opw*1.2+",height="+oph+",resizable=no,scrollbars=yes,status=no");}
function insertlink(idEdit,url,opw,oph){if(!Error(idEdit))return;window.open(functionstr+url,null,"modal=yes,width="+opw*1.2+",height="+oph+",resizable=no,scrollbars=yes,status=no");}
function GetLink()
{var idEdit=document.getElementById("dntb_"+tid).contentWindow;if(!Error(idEdit))return;var oSel=GetSelection(idEdit);var el=null;el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"A");if(!el)el=GetElement(oSel.startContainer,"A");var file=new Array;if(el){file[0]=el.href;file[1]=el.target;}
return file;}
function GetImgLink()
{var idEdit=document.getElementById("dntb_"+tid).contentWindow;if(!Error(idEdit))return;var oSel=GetSelection(idEdit);var el=null;el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"IMG");if(!el)el=GetElement(oSel.startContainer,"IMG");var file=null;if(el){file=readNodes(oSel.cloneContents(),false);}
return file;}
function GetFile()
{var idEdit=document.getElementById("dntb_"+tid).contentWindow;if(!Error(idEdit))return;var oSel=GetSelection(idEdit);var el=null;el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"A");if(!el)el=GetElement(oSel.startContainer,"A");var file=new Array;if(el){file[0]=el.href;file[1]=el.textContent;}
return file;}
function inserImg(idEdit,url,opw,oph){if(!Error(idEdit))return;window.open(functionstr+url,null,"modal=yes,width="+opw*1.2+",height="+oph+",resizable=no,scrollbars=yes,status=no");}
function insertTemplate(idEdit,url,opw,oph){if(!Error(idEdit))return;window.open(functionstr+url,null,"modal=yes,width="+opw*1.2+",height="+oph+",resizable=no,scrollbars=yes,status=no");}
function GetImg()
{var idEdit=document.getElementById("dntb_"+tid).contentWindow;if(!Error(idEdit))return;var oSel=GetSelection(idEdit);var el=null;el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"IMG");var image=new Array;if(el){image[0]=el.width;image[1]=el.height;image[2]=el.alt;image[3]=el.src;if(!el.align)
{image[4]='';}
else{image[4]=el.align;}image[5]=el.vspace;image[6]=el.hspace;}
return image;}
function openDialog_plugin(idEdit,url,opw,oph){if(!Error(idEdit))return;window.open(url,null,"modal=yes,width="+opw+",height="+oph+",resizable=no,scrollbars=yes,status=no");}
function plugin_execommand(idEdit,objvalue){idEdit.focus();pasterTag(objvalue);}
function create(idEdit,what){if(!Error(idEdit))return;idEdit.focus();idEdit.document.execCommand(what,false,null);}
function specialtype(idEdit,Mark){if(!Error(idEdit))return;if(Mark!="marquee"){pasterTag("<"+Mark+">"+idEdit.getSelection()+"</"+Mark+">");idEdit.focus();}
else
if(Mark=="marquee")
{window.open(functionstr+"custom.aspx?type=marquee",null,"modal=yes,width=300pt,height=100pt,resizable=no,scrollbars=yes,status=no");}}
function GetSelection(idEdit){idEdit.focus();selection=idEdit.getSelection();range=selection?selection.getRangeAt(0):idEdit.document.createRange();return range;}
function GetTable()
{var idEdit=document.getElementById("dntb_"+tid).contentWindow;if(!Error(idEdit))return;var oSel=GetSelection(idEdit);var el=null;el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TH");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TR");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TABLE");if(!el)el=GetElement(oSel.startContainer,"TABLE");var tables=new Array;if(el){tables[0]=el.rows.length;tables[1]=el.rows[0].cells.length;tables[2]=el.align;tables[3]=el.border;tables[4]=el.bgColor;tables[5]=el.cellPadding;tables[6]=el.cellSpacing;tables[7]=el.style.borderBottomColor;tables[8]=el.width;}
return tables;}
function GetDiv()
{var idEdit=document.getElementById("dntb_"+tid).contentWindow;if(!Error(idEdit))return;var oSel=GetSelection(idEdit);var el=null;el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"DIV");if(!el)el=GetElement(oSel.startContainer,"DIV");var divs=new Array;if(el){divs[0]=el.style.width;divs[1]=el.style.height;divs[2]=el.align;divs[3]=el.style.borderWidth;divs[4]=el.style.backgroundColor;divs[5]=el.style.borderColor;divs[6]=el.style.wordBreak;divs[7]=el.style.position;divs[8]=el.style.left;divs[9]=el.style.top;divs[10]=el.style.zIndex;divs[11]=el.style.borderStyle;divs[12]=el.style.overflow;}
return divs;}
function GetElement(oEl,sTag)
{while(oEl!=null&&oEl.tagName!=sTag)
oEl=oEl.parentNode;return oEl;}
function inserTables(idEdit,opw,oph){if(!Error(idEdit))return;window.open(functionstr+"table.aspx",null,"modal=yes,width="+opw*2+",height="+oph*1.8+",resizable=no,scrollbars=yes,status=no");}
function insertDiv(idEdit,opw,oph){if(!Error(idEdit))return;window.open(functionstr+"div.aspx",null,"modal=yes,width="+opw*2+",height="+oph*1.8+",resizable=no,scrollbars=yes,status=no");}
function openDialog(idEdit,url,opw,oph,type){if(!Error(idEdit))return;window.open(url+"?type="+type,null,"modal=yes,width="+opw*1.6+"pt,height="+oph*1.3+"pt,resizable=no,scrollbars=yes,status=no");}
function format(idEdit,what,opt){if(idEdit==null){idEdit=document.getElementById("dntb_"+tid).contentWindow;}
if(!Error(idEdit))return;idEdit.focus();if(opt=="removeFormat"){what=opt;opt=null;}
if(opt=="custom"){window.open(functionstr+"custom.aspx?type=font",null,"modal=yes,width=300pt,height=100pt,resizable=no,scrollbars=yes,status=no");return;}
if(what=="copy"){copycontent(idEdit);return;}
if(what=="print"){idEdit.print();return;}
if(what=="cut"){cutcontent(idEdit);return;}
if(opt==null)idEdit.document.execCommand(what,false,null)
else idEdit.document.execCommand(what,false,opt)}
function insertNodeAtSelection(text,idEdit){idEdit.focus();var sel=idEdit.getSelection();var range=sel?sel.getRangeAt(0):idEdit.document.createRange();sel.removeAllRanges();range.deleteContents();var node=range.startContainer;var pos=range.startOffset;switch(node.nodeType){case Node.ELEMENT_NODE:if(text.nodeType==Node.DOCUMENT_FRAGMENT_NODE){selNode=text.firstChild;}else{selNode=text;}
node.insertBefore(text,node.childNodes[pos]);add_range(selNode,idEdit);break;case Node.TEXT_NODE:if(text.nodeType==Node.TEXT_NODE){var text_length=pos+text.length;node.insertData(pos,text.data);range=idEdit.createRange();range.setEnd(node,text_length);range.setStart(node,text_length);sel.addRange(range);}else{node=node.splitText(pos);var selNode;if(text.nodeType==Node.DOCUMENT_FRAGMENT_NODE){selNode=text.firstChild;}else{selNode=text;}node.parentNode.insertBefore(text,node);add_range(selNode,idEdit);}break;}}function add_range(node,idEdit){idEdit.focus();var sel=idEdit.getSelection();var range=idEdit.document.createRange();range.selectNodeContents(node);sel.removeAllRanges();sel.addRange(range);}
function inserObject(idEdit,obj,objvalue){if(idEdit==null){idEdit=document.getElementById("dntb_"+tid).contentWindow;}
if(!Error(idEdit))return;idEdit.focus();switch(obj){case"pageoutput":pasterTag("<hr id=pageoutput/>");break;case"pagebreak":pasterTag("<div title=\"Print Page Break\" style=\"font-size: 1px; page-break-before: always; vertical-align: middle; height: 1px; background-color: #c0c0c0\">&nbsp;</div>");break;case"file":var fileurl;if(objvalue[0].toLowerCase().indexOf('http')==-1){fileurl='http://'+location.host+functionstr+objvalue[0];}
else{fileurl=objvalue[0].toLowerCase();}pasterTag("<a href="+fileurl+">"+objvalue[1]+"</a>");break;case"modfile":var oSel=GetSelection(idEdit);var el=null;el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"A");el=GetElement(oSel.startContainer,"A");if(objvalue[0].toLowerCase().indexOf('http')==-1){el.href='http://'+location.host+functionstr+objvalue[0];}else{el.href=objvalue[0];}
el.textContent=objvalue[1];break;case"link":if(!objvalue)return;if(objvalue[2]==''||objvalue[2]==null){objvalue[2]=objvalue[0];}if(objvalue[1]!=''){pasterTag("<a href="+objvalue[0]+" target="+objvalue[1]+">"+objvalue[2]+"</a>");}else{pasterTag("<a href="+objvalue[0]+">"+objvalue[2]+"</a>");}
break;case"editlink":if(!objvalue)return;var oSel=GetSelection(idEdit);var el=null;el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"A");if(!el)el=GetElement(oSel.startContainer,"A");if(el){el.href=objvalue[0];el.target=objvalue[1];}
break;case"template":pasterTag(objvalue);break;case"img":var imgurl;if(objvalue[0].toLowerCase().indexOf('http')==-1){imgurl='http://'+location.host+functionstr+objvalue[0];}
else{imgurl=objvalue[0];}objvalue[1]=objvalue[1]?" width='"+objvalue[1]+"' ":" ";objvalue[2]=objvalue[2]?"height='"+objvalue[2]+"' ":"";objvalue[3]=objvalue[3]?"alt='"+objvalue[3]+"' ":"";objvalue[4]=objvalue[4]?"align='"+objvalue[4]+"' ":"";objvalue[5]=objvalue[5]?"vspace='"+objvalue[5]+"' ":"";objvalue[6]=objvalue[6]?"hspace='"+objvalue[6]+"'":"";pasterTag("<img src="+imgurl+objvalue[1]+objvalue[2]+objvalue[3]+objvalue[4]+objvalue[5]+objvalue[6]+">");if(getimagespathid!=""){document.getElementById(getimagespathid).value=imgurl;}break;case"modimg":var oSel=GetSelection(idEdit);var el=null;if(oSel.startContainer.childNodes[oSel.startOffset].tagName!=null){el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"IMG");}
if(objvalue[0].toLowerCase().indexOf('http')==-1){el.src='http://'+location.host+functionstr+objvalue[0];}else{el.src=objvalue[0];}
el.width=objvalue[1];el.height=objvalue[2];el.alt=objvalue[3];el.align=objvalue[4];el.vspace=objvalue[5];el.hspace=objvalue[6];break;case"table":pasterTag(objvalue);break;case"div":pasterTag(objvalue);break;case"modtable":var oSel=GetSelection(idEdit);var el=null;if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TH");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TR");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TABLE");if(!el)el=GetElement(oSel.startContainer,"TABLE");el.cellPadding=objvalue[0];el.cellSpacing=objvalue[1];el.border=objvalue[2];el.width=objvalue[3];el.style.borderColor=objvalue[4];el.bgColor=objvalue[5];el.align=objvalue[6];for(var i=el.rows.length;i>objvalue[7];i--){el.deleteRow(1);}
for(var i=el.rows[0].cells.length;i>objvalue[8];i--){for(var j=0;j<el.rows.length;j++){el.rows[j].deleteCell(1);}}
for(var i=el.rows.length;i<objvalue[7];i++){var elRow=el.insertRow(1);for(var j=0;j<el.rows[0].cells.length;j++){var elCell=elRow.insertCell(j);elCell.innerHTML="&nbsp;";}}
for(var i=el.rows[0].cells.length;i<objvalue[8];i++){for(var j=0;j<el.rows.length;j++){var elCell=el.rows[j].insertCell(1);elCell.innerHTML="&nbsp;"}}
break;case"moddiv":var oSel=GetSelection(idEdit);var el=null;if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"DIV");if(!el)el=GetElement(oSel.startContainer,"DIV");el.style.width=objvalue[0];el.style.height=objvalue[1];el.align=objvalue[2];el.style.borderWidth=objvalue[3];el.style.backgroundColor=objvalue[4];el.style.borderColor=objvalue[5];el.style.wordBreak=objvalue[6];el.style.position=objvalue[7];el.style.left=objvalue[8];el.style.top=objvalue[9];el.style.zIndex=objvalue[10];el.style.borderStyle=objvalue[11];el.style.overflow=objvalue[12];break;case"excel":var oSel=GetSelection(idEdit);pasterTag("<object classid='clsid:0002E510-0000-0000-C000-000000000046' id='Spreadsheet1' codebase='file:\\Bob\software\office2000\msowc.cab' width='100%' height='250'><param name='HTMLURL' value><param name='HTMLData' value='&lt;html xmlns:x=&quot;urn:schemas-microsoft-com:office:excel&quot;xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;&lt;head&gt;&lt;style type=&quot;text/css&quot;&gt;&lt;!--tr{mso-height-source:auto;}td{black-space:nowrap;}.wc4590F88{black-space:nowrap;font-family:ו;mso-number-format:General;font-size:auto;font-weight:auto;font-style:auto;text-decoration:auto;mso-background-source:auto;mso-pattern:auto;mso-color-source:auto;text-align:general;vertical-align:bottom;border-top:none;border-left:none;border-right:none;border-bottom:none;mso-protection:locked;}--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;!--[if gte mso 9]&gt;&lt;xml&gt;&lt;x:ExcelWorkbook&gt;&lt;x:ExcelWorksheets&gt;&lt;x:ExcelWorksheet&gt;&lt;x:OWCVersion&gt;9.0.0.2710&lt;/x:OWCVersion&gt;&lt;x:Label Style='border-top:solid .5pt silver;border-left:solid .5pt silver;border-right:solid .5pt silver;border-bottom:solid .5pt silver'&gt;&lt;x:Caption&gt;Microsoft Office Spreadsheet&lt;/x:Caption&gt; &lt;/x:Label&gt;&lt;x:Name&gt;Sheet1&lt;/x:Name&gt;&lt;x:WorksheetOptions&gt;&lt;x:Selected/&gt;&lt;x:Height&gt;7620&lt;/x:Height&gt;"+"&lt;x:Width&gt;15240&lt;/x:Width&gt;&lt;x:TopRowVisible&gt;0&lt;/x:TopRowVisible&gt;&lt;x:LeftColumnVisible&gt;0&lt;/x:LeftColumnVisible&gt; &lt;x:ProtectContents&gt;False&lt;/x:ProtectContents&gt; &lt;x:DefaultRowHeight&gt;210&lt;/x:DefaultRowHeight&gt; &lt;x:StandardWidth&gt;2389&lt;/x:StandardWidth&gt; &lt;/x:WorksheetOptions&gt; &lt;/x:ExcelWorksheet&gt;&lt;/x:ExcelWorksheets&gt; &lt;x:MaxHeight&gt;80%&lt;/x:MaxHeight&gt;&lt;x:MaxWidth&gt;80%&lt;/x:MaxWidth&gt;&lt;/x:ExcelWorkbook&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;table class=wc4590F88 x:str&gt;&lt;col width=&quot;56&quot;&gt;&lt;tr height=&quot;14&quot;&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;'> <param name='DataType' value='HTMLDATA'> <param name='AutoFit' value='0'><param name='DisplayColHeaders' value='-1'><param name='DisplayGridlines' value='-1'><param name='DisplayHorizontalScrollBar' value='-1'><param name='DisplayRowHeaders' value='-1'><param name='DisplayTitleBar' value='-1'><param name='DisplayToolbar' value='-1'><param name='DisplayVerticalScrollBar' value='-1'> <param name='EnableAutoCalculate' value='-1'> <param name='EnableEvents' value='-1'><param name='MoveAfterReturn' value='-1'><param name='MoveAfterReturnDirection' value='0'><param name='RightToLeft' value='0'><param name='ViewableRange' value='1:65536'></object>");break;case"symbol":if(!objvalue)return;pasterTag(objvalue);break;case"nowdate":pasterTag(objvalue);break;case"nowtime":var d=new Date();pasterTag(d.toLocaleTimeString());break;case"swf":if(!objvalue)return;pasterTag("<embed src=\""+objvalue[0]+"\" quality=high pluginspage='http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash' type='application/x-shockwave-flash' width="+objvalue[1]+" height="+objvalue[2]+"></embed>");break;case"rm":if(!objvalue)return;pasterTag("<OBJECT classid=CLSID:CFCDAA03-8BE4-11CF-B84B-0020AFBBCCFA class=OBJECT id=RAOCX width="+objvalue[1]+" height="+objvalue[2]+"><PARAM NAME=SRC VALUE="+objvalue[0]+"><PARAM NAME=CONSOLE VALUE=Clip1><PARAM NAME=CONTROLS VALUE=imagewindow><PARAM NAME=AUTOSTART VALUE=true></OBJECT><br /><OBJECT classid=CLSID:CFCDAA03-8BE4-11CF-B84B-0020AFBBCCFA height=32 id=video2 width="+objvalue[1]+"><PARAM name=src value="+objvalue[0]+"><PARAM NAME=AUTOSTART VALUE=-1><PARAM NAME=CONTROLS VALUE=controlpanel><PARAM NAME=CONSOLE VALUE=Clip1></OBJECT>");break;case"music":if(!objvalue)return;pasterTag("<EMBED src="+url+" width="+objvalue[1]+" height="+objvalue[2]+" autostart=true loop="+objvalue[4]+" volume="+objvalue[3]+">");break;case"mp":if(!objvalue)return;pasterTag("<object  classid='CLSID:22d6f312-b0f6-11d0-94ab-0080c74c7e95' class='OBJECT' id=MediaPlayer width='"+objvalue[1]+"' height='"+objvalue[2]+"' ><param name=ShowStatusBar value=-1><PARAM NAME=AUTOSTART VALUE=true><param name=Filename value='"+objvalue[0]+"'><embed type=application/x-oleobject codebase=http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#Version=5,1,52,701 flename=mp loop="+objvalue[4]+" src='"+objvalue[0]+"' width='"+objvalue[1]+"' height='"+objvalue[2]+"'></embed></object>");break;case"flv":if(!objvalue)return;pasterTag("<embed src='"+functionstr+"flv.swf?file="+objvalue[0]+"&autostart=true' type='application/x-shockwave-flash' wmode='transparent' allowfullscreen='true' pluginspage='http://www.macromedia.com/go/getflashplayer' quality='high' width='"+objvalue[1]+"' height='"+objvalue[2]+"'>");break;case"mp3":if(!objvalue)return;pasterTag("<embed wmode='transparent' width="+objvalue[1]+" height="+objvalue[2]+" src='"+functionstr+"mp3player.swf?file="+objvalue[0]+"&autoStart=true&backColor=000000&frontColor=ffffff&songVolume=90' type='application/x-shockwave-flash' pluginspage='http://www.macromedia.com/go/getflashplayer'/>");break;case"qt":if(!objvalue)return;pasterTag("<embed src="+objvalue[0]+" width="+objvalue[1]+" height="+objvalue[2]+" autoplay=true loop="+objvalue[4]+"  controller=true playeveryframe=false cache=false scale=TOFIT bgcolor=#000000 kioskmode=false targetcache=false pluginspage=http://www.apple.com/quicktime/>");break;case"other":if(!objvalue)return;pasterTag("<EMBED src="+objvalue[0]+" width="+objvalue[1]+" height="+objvalue[2]+" autostart=true loop="+objvalue[4]+" >");break;case"emot":if(!objvalue)return;pasterTag("<IMG SRC='"+objvalue+"'>");break;case"bgcolor":if(!objvalue)return;var oSel=GetSelection(idEdit);var el=null;el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TD");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TH");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TR");if(!el)el=GetElement(oSel.startContainer.childNodes[oSel.startOffset],"TABLE");if(!el)el=GetElement(oSel.startContainer,"TABLE");if(el)
el.bgColor=objvalue;else
idEdit.document.execCommand('hilitecolor',false,objvalue);idEdit.focus();break;case"getpage":if(!objvalue)return;pasterTag(objvalue);break;case"code":pasterTag('<table width=95% border="0" align="Center" cellpadding="6" cellspacing="0" style="border: 1px Dotted #6595d6; TABLE-LAYOUT: fixed"><tr><td bgcolor=#e8f4ff style="WORD-WRAP: break-word"><font style="color: #990000;font-weight:bold">'+codetitle+'</font><br />'+idEdit.getSelection()+'</td></tr></table>');break;case"quote":pasterTag('<table width=95% border="0" align="Center" cellpadding="6" cellspacing="0" style="border: 1px Dotted #6595d6; TABLE-LAYOUT: fixed"><tr><td bgcolor=#e8f4ff style="WORD-WRAP: break-word"><font style="color: #990000;font-weight:bold">'+quotetitle+'</font><br />'+idEdit.getSelection()+'</td></tr></table>');break;case"sub":pasterTag('<sub>'+idEdit.getSelection()+'</sub>');case"sup":pasterTag('<sup>'+idEdit.getSelection()+'</sup>');break;case"msn":pasterTag("<a href='msnim:chat?contact="+objvalue+"' target=blank><img alt='"+msncheck+"' style='border-style: none;' src='http://messenger.services.live.com/users/"+objvalue+"/presenceimage?mkt=zh-cn' width='16' height='16' /></a>");break;case"icq":pasterTag("<a target=_blank href=http://wwp.icq.com/scripts/search.dll?to="+objvalue+"><img border=0 align=absmiddle src=http://web.icq.com/whitepages/online?icq="+objvalue+"&img=5 alt="+icqcheck+" /></a>");break;case"qq":pasterTag("<a target=blank href=tencent://message/?uin="+objvalue[0]+"&Site=N&Menu=yes><img border=0 alt='"+sendmsg+"' src=http://wpa.qq.com/pa?p=1:"+objvalue[0]+":"+objvalue[1]+"></a>");break;case"calculator":pasterTag(objvalue);break;case"marquee":if(!objvalue)return;pasterTag("<marquee behavior=alternate scrollamount="+objvalue+">"+idEdit.getSelection()+"</marquee>");break;case"font":if(!objvalue)return;idEdit.document.execCommand("fontname",false,objvalue);break;default:alert(errorparameter);break;}
sel=null;}
function checkMedia(idEdit,url){if(idEdit==null){idEdit=document.getElementById("dntb_"+tid).contentWindow;}
if(!Error(idEdit))return;var afilename,bfilename,filetype;if(url[0].toLowerCase().indexOf('http')==-1){url[0]=functionstr+url[0];}
if(!url)return;afilename=url[0].split("/");bfilename=afilename[afilename.length-1];filetype=bfilename.split(".");switch(filetype[filetype.length-1].toLowerCase()){case"swf":inserObject(idEdit,'swf',url);break;case"mov":inserObject(idEdit,'qt',url);break;case"asf":inserObject(idEdit,'mp',url);break;case"asx":inserObject(idEdit,'mp',url);break;case"wmv":inserObject(idEdit,'mp',url);break;case"wma":inserObject(idEdit,'music',url);break;case"wmf":inserObject(idEdit,'mp',url);break;case"avi":inserObject(idEdit,'mp',url);break;case"mpeg":inserObject(idEdit,'mp',url);break;case"mpg":inserObject(idEdit,'mp',url);break;case"rm":inserObject(idEdit,'rm',url);break;case"rmvb":inserObject(idEdit,'rm',url);break;case"mp3":inserObject(idEdit,'mp3',url);break;case"mp4":inserObject(idEdit,'music',url);break;case"ra":inserObject(idEdit,'music',url);break;case"wav":inserObject(idEdit,'music',url);break;case"mid":inserObject(idEdit,'music',url);break;case"midi":inserObject(idEdit,'music',url);break;case"flv":inserObject(idEdit,'flv',url);break;default:inserObject(idEdit,'other',url);break;}}
function searchContent(){window.open(functionstr+'search.aspx',null,"modal=yes,width=330px,height=160px,resizable=no,scrollbars=yes,status=no");}
function findandreplace(str,replacetext,type,casesensitive,checked){var idEdit=dntb_WebEditor1;idEdit.focus();if(idEdit.find(str,casesensitive,checked)){if(type=='replace'){pasterTag(replacetext);alert(replacesuccessful);}else{alert(findsuccessful);}}else{alert(notfound);}}
function setMode(idEdit,tbid,NewMode,Status,nid){if(NewMode!=EditMode)
{if(NewMode=="EDIT")
{idEdit.document.body.disabled=false;if(idEdit.document.designMode.toLowerCase()=="on"){idEdit.document.body.innerHTML=idEdit.document.body.textContent;}else{var temp=(EditMode=="SOURCE")?idEdit.document.body.textContent:idEdit.document.body.innerHTML;idEdit.document.designMode="On";idEdit.document.open();idEdit.document.write(sHeader);idEdit.document.body.innerHTML=temp;idEdit.document.close();temp=null;}
document.getElementById("dntb_"+nid).contentDocument.addEventListener("click",popupmenu_hide,false);document.getElementById("dntb_"+nid).contentDocument.addEventListener("mouseup",function(e){checkformat(nid)},true);document.getElementById("dntb_"+nid).contentDocument.addEventListener("keyup",function(e){checkformat(nid)},true);document.getElementById("dntb_"+nid).contentDocument.addEventListener("dblclick",function(e){dbclickcheck(e)},true);document.getElementById("dntb_"+nid).contentDocument.addEventListener("contextmenu",rc=function(e){addmenu(nid);e.cancelBubble=true},true);}
else
if(NewMode=="SOURCE")
{var temp;if(PathType!='AbsoluteFull'){temp=urlchange(idEdit.document.body.innerHTML);}else{temp=idEdit.document.body.innerHTML;}
if(idEdit.document.designMode.toLowerCase()=="on"){idEdit.document.body.textContent=temp;}
else{idEdit.document.designMode="On";idEdit.document.open();idEdit.document.write(sHeader);idEdit.document.body.textContent=temp;idEdit.document.close();temp=null;}
document.getElementById("dntb_"+nid).contentDocument.removeEventListener("contextmenu",rc,true);if(!sourcestr){idEdit.document.body.disabled=true;idEdit.document.body.contentEditable?idEdit.document.body.contentEditable=false:idEdit.document.designMode='off';}}
else if(NewMode=="VIEW")
{if(EditMode=="SOURCE"){var temp=idEdit.document.body.textContent?idEdit.document.body.textContent:idEdit.document.body.innerText;}else{var temp=idEdit.document.body.innerHTML;}
idEdit.document.open();idEdit.document.write(sHeader2+temp);idEdit.document.close();idEdit.document.designMode="off";}
bMode=Status;EditMode=NewMode;for(var i=0;i<tbid.children.length;i++)
tbid.children[i].disabled=(!bMode);}!opera?idEdit.focus():document.getElementById('dntb_'+nid).focus();}
function findPosX(obj)
{var curleft=0;if(obj.offsetParent){while(obj.offsetParent){curleft+=obj.offsetLeft;obj=obj.offsetParent;}}
else if(obj.x)
curleft+=obj.x;return curleft;}
function findPosY(obj)
{var curtop=0;if(obj.offsetParent){while(obj.offsetParent){curtop+=obj.offsetTop;obj=obj.offsetParent;}}
else if(obj.y)
curtop+=obj.y;return curtop;}
function goUndoRedo(type,idEdit){if(type==1){format(idEdit,'Redo');}else{format(idEdit,'Undo');}}
function formatstripper(idEdit,type)
{if(!Error(idEdit))return;idEdit.document.body.innerHTML=cleanCode(idEdit.document.body.innerHTML,type);alert(cleancodesuccessful);}